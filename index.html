<!doctype html>
<html>
<head>
	<meta charset="utf-8" />
	<title>Three.js Template</title>
	<meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />
	<!-- build:css styles/combined.css -->
	<style type="text/css">
		html {padding: 0; margin: 0; overflow: hidden; cursor: default; height: 100%;}
	</style>
	<link href="styles/main.css" rel="stylesheet">
	<!-- endbuild -->
</head>
<body>

	<div id="canvasContainer"></div>


<!-- Random Shaders -->
	<script type="x-shader/x-vertex" id="randVert">
	varying vec2 vUv;

	void main() {
		vUv = uv;
		gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);
	}
	</script>

	<script type="x-shader/x-fragment" id="randFrag">
	varying vec2 vUv;


	float rand(vec2 co){
		return fract(sin(dot(co.xy, vec2(12.8273, 67.245))) * 53726.17623);
	}

	void main() {
		vec3 col;
		col.g = rand(vec2(vUv.x, vUv.y + 1.0));
		col.b = rand(vec2(vUv.x, vUv.y + 2.0));
		col.r = rand(vec2(vUv.xy));

		col *= 1.1;
		gl_FragColor = vec4(col, 1.0);
	}
	</script>
<!-- End Random Shaders -->







<!-- Velocity Shaders -->
	<script type="x-shader/x-vertex" id="velVert">
	varying vec2 vUv;

	void main() {
		vUv = uv;
		gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);
	}
	</script>
	<script type="x-shader/x-fragment" id="velFrag">
	varying vec2 vUv;
	uniform sampler2D velTex;
	uniform sampler2D posTex;
	uniform vec3 targetPosition;

	void main() {
		vec3 velocity = texture2D(velTex, vUv).rgb;
		vec3 pos = texture2D(posTex, vUv).rgb;

		float distance = max(distance(targetPosition, pos), 1.0);
		vec3 direction = normalize(targetPosition - pos);
		velocity = velocity + ((direction / distance) * 0.5);
		//velocity -= vec3(0.01);

		gl_FragColor = vec4( velocity, 1.0 );
	}
	</script>
<!-- End Velocity Shaders -->






<!-- Position Shaders -->
	<script type="x-shader/x-vertex" id="posVert">
	varying vec2 vUv;

	void main() {
		vUv = uv;
		gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);
	}
	</script>
	<script type="x-shader/x-fragment" id="posFrag">
	varying vec2 vUv;
	uniform sampler2D velTex;
	uniform sampler2D posTex;

	void main() {
		vec3 velocity = texture2D(velTex, vUv).rgb;
		vec3 pos = texture2D(posTex, vUv).rgb;
		pos += velocity;
		gl_FragColor = vec4( pos, 1.0 );
	}
	</script>
<!-- End Position Shaders -->







<!-- Display Shaders -->
	<script type="x-shader/x-vertex" id="dispVert">
	uniform sampler2D posTex;
	varying float dist;

	void main() {
		vec3 pos = texture2D(posTex, position.xy).rgb;
		dist = smoothstep(0.0, 100.0, distance(vec3(0.0), pos));
		gl_PointSize = 1.2;
		gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
	}
	</script>

	<script type="x-shader/x-fragment" id="dispFrag">
	varying float dist;

	void main() {
		gl_FragColor = vec4(1.0-dist, 0.5-dist, dist-0.1, 0.5);
	}
	</script>
<!-- End Display Shaders -->






	<!-- build:js main.js -->
	<script src="bower_components/jquery/dist/jquery.min.js"></script>
	<script src="bower_components/threejs/build/three.min.js"></script>
	<script src="src/OrbitControls.js"></script>
	<!-- endbuild -->

	<script src="src/main.js"></script>
</body>
</html>
